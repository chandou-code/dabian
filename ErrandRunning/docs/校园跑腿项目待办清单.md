# 校园跑腿项目待办清单

## 项目现状分析

当前项目已实现基本的登录、发布任务和接单功能，但仍有许多功能模块需要完善。本待办清单基于对现有前端代码结构的分析，按照不同角色视角和功能领域进行详细规划。

## 一、用户端功能

### 1. 用户资料管理

| 优先级 | 功能点 | 详细描述 | 技术实现提示 | 关联文件 |
|--------|--------|----------|--------------|----------|
| 高 | 个人资料编辑 | 允许用户修改昵称、头像、手机号等基本信息 | 使用Form组件，调用用户资料更新API | `pages/user/profile.vue` |
| 中 | 身份认证 | 支持学生认证（学号、学生证照片上传） | 图片上传组件 + 后端验证 | `pages/user/profile.vue` |
| 中 | 密码修改 | 支持用户修改登录密码 | 表单验证 + 密码强度检测 | `pages/user/profile.vue` |
| 低 | 角色切换 | 允许用户在发布者和跑腿员角色之间切换 | 状态管理 + 后端角色更新 | `pages/user/profile.vue` |

### 2. 订单管理

| 优先级 | 功能点 | 详细描述 | 技术实现提示 | 关联文件 |
|--------|--------|----------|--------------|----------|
| 高 | 订单状态追踪 | 实时显示订单当前状态和预计完成时间 | WebSocket或轮询更新 | `pages/order/detail.vue` |
| 高 | 订单历史记录 | 按状态分类显示历史订单 | 分页加载 + 状态筛选 | `pages/order/list.vue` |
| 中 | 订单取消原因 | 取消订单时需要选择原因 | 弹出选择器组件 | `pages/task/detail.vue` |
| 低 | 订单筛选与排序 | 支持按时间、价格、距离等维度筛选排序 | 前端排序 + 后端筛选API | `pages/order/list.vue` |

### 3. 支付系统

| 优先级 | 功能点 | 详细描述 | 技术实现提示 | 关联文件 |
|--------|--------|----------|--------------|----------|
| 高 | 在线支付集成 | 集成微信支付、支付宝等支付方式 | 支付SDK集成 + 后端回调 | 新增 `pages/pay/index.vue` |
| 中 | 钱包管理 | 显示余额、充值记录、提现功能 | 余额查询API + 提现申请API | 新增 `pages/user/wallet.vue` |
| 中 | 优惠券系统 | 领取、使用优惠券 | 优惠券列表API + 优惠码验证 | 新增 `pages/user/coupon.vue` |
| 低 | 支付密码设置 | 为钱包操作设置支付密码 | 密码加密存储 + 验证 | `pages/user/profile.vue` |

### 4. 消息通知系统

| 优先级 | 功能点 | 详细描述 | 技术实现提示 | 关联文件 |
|--------|--------|----------|--------------|----------|
| 高 | 系统通知 | 接收平台公告、活动通知等 | WebSocket + 本地存储 | `pages/notification/list.vue` |
| 高 | 订单通知 | 订单状态变更、新消息提醒 | WebSocket + 消息中心 | `pages/notification/list.vue` |
| 中 | 未读消息提示 | 在相关页面显示未读消息数量 | 本地存储未读状态 | `pages/index/index.vue` |
| 低 | 消息设置 | 允许用户设置通知偏好 | 本地存储用户设置 | 新增 `pages/user/notification-setting.vue` |

### 5. 评价体系

| 优先级 | 功能点 | 详细描述 | 技术实现提示 | 关联文件 |
|--------|--------|----------|--------------|----------|
| 高 | 订单评价 | 完成订单后对骑手进行评分和评论 | 星级评分组件 + 评价提交API | `pages/evaluate/index.vue` |
| 中 | 评价回复 | 骑手可以回复用户评价 | 评论回复API | `pages/evaluate/index.vue` |
| 中 | 评价管理 | 查看自己的评价历史和他人对自己的评价 | 评价列表API | 新增 `pages/user/evaluation-history.vue` |
| 低 | 评价筛选 | 按评分、时间等筛选评价 | 前端筛选 + 后端API | `pages/runner/detail.vue` |

### 6. 地图服务

| 优先级 | 功能点 | 详细描述 | 技术实现提示 | 关联文件 |
|--------|--------|----------|--------------|----------|
| 高 | 实时定位 | 获取用户当前位置用于任务发布和骑手定位 | 高德/百度地图SDK | `pages/map/index.vue` |
| 高 | 路径规划 | 显示取件和送达地点的最优路线 | 地图SDK路径规划API | `pages/map/index.vue` |
| 中 | 骑手位置追踪 | 在订单详情页显示骑手实时位置 | WebSocket + 地图标记 | `pages/order/detail.vue` |
| 低 | 地理围栏 | 限定服务范围，超出范围的任务不显示 | 地图SDK地理围栏API | `pages/map/index.vue` |

## 二、骑手端功能

### 1. 骑手资料管理

| 优先级 | 功能点 | 详细描述 | 技术实现提示 | 关联文件 |
|--------|--------|----------|--------------|----------|
| 高 | 骑手认证 | 骑手身份认证（身份证、学生证） | 图片上传 + 后端审核 | `pages/runner/detail.vue` |
| 中 | 服务状态设置 | 骑手可以设置在线/离线状态 | 状态更新API | `pages/runner/detail.vue` |
| 低 | 服务区域设置 | 骑手可以设置常服务区域 | 地图多边形选择 | `pages/runner/detail.vue` |

### 2. 任务管理

| 优先级 | 功能点 | 详细描述 | 技术实现提示 | 关联文件 |
|--------|--------|----------|--------------|----------|
| 高 | 任务筛选 | 骑手可以按距离、价格、类型筛选任务 | 前端筛选 + 后端API | `pages/task/task-list.vue` |
| 中 | 任务导航 | 提供到取件和送达地点的导航功能 | 地图SDK导航API | `pages/map/index.vue` |
| 低 | 任务统计 | 显示骑手完成的任务数量、总收入等 | 统计数据API | `pages/runner/detail.vue` |

### 3. 订单处理

| 优先级 | 功能点 | 详细描述 | 技术实现提示 | 关联文件 |
|--------|--------|----------|--------------|----------|
| 高 | 开始配送 | 骑手确认开始配送，更新订单状态 | 状态更新API | `pages/task/detail.vue` |
| 高 | 完成订单 | 骑手确认完成订单，触发评价流程 | 状态更新API | `pages/task/detail.vue` |
| 中 | 订单异常处理 | 处理订单异常情况（如地址错误、联系不上用户） | 异常上报API | `pages/task/detail.vue` |

## 三、管理端功能

### 1. 用户管理

| 优先级 | 功能点 | 详细描述 | 技术实现提示 | 关联文件 |
|--------|--------|----------|--------------|----------|
| 高 | 用户列表 | 查看所有注册用户，支持筛选和搜索 | 分页查询 + 高级筛选 | 新增 `pages/admin/user-list.vue` |
| 中 | 用户详情 | 查看用户详细信息、历史订单、评价等 | 详情查询API | 新增 `pages/admin/user-detail.vue` |
| 低 | 用户封禁 | 对违规用户进行封禁操作 | 权限管理API | 新增 `pages/admin/user-list.vue` |

### 2. 订单管理

| 优先级 | 功能点 | 详细描述 | 技术实现提示 | 关联文件 |
|--------|--------|----------|--------------|----------|
| 高 | 订单列表 | 查看所有订单，支持多维度筛选 | 高级查询API | 新增 `pages/admin/order-list.vue` |
| 中 | 订单详情 | 查看订单详细信息，包括历史状态变更 | 详情查询API | 新增 `pages/admin/order-detail.vue` |
| 中 | 订单干预 | 对异常订单进行人工干预（如改派、取消） | 订单管理API | 新增 `pages/admin/order-detail.vue` |

### 3. 数据统计

| 优先级 | 功能点 | 详细描述 | 技术实现提示 | 关联文件 |
|--------|--------|----------|--------------|----------|
| 高 | 运营数据 | 统计平台交易量、用户活跃度、骑手活跃度等 | 数据统计API + 图表组件 | 新增 `pages/admin/stats.vue` |
| 中 | 财务报表 | 统计平台收入、骑手收入、订单均价等 | 财务数据API + 图表组件 | 新增 `pages/admin/finance.vue` |
| 低 | 趋势分析 | 展示订单量、用户增长等趋势图表 | 时间序列数据API + 图表组件 | 新增 `pages/admin/stats.vue` |

### 4. 系统设置

| 优先级 | 功能点 | 详细描述 | 技术实现提示 | 关联文件 |
|--------|--------|----------|--------------|----------|
| 中 | 公告管理 | 发布、编辑、删除平台公告 | 公告管理API | 新增 `pages/admin/notice.vue` |
| 中 | 优惠券管理 | 创建、管理平台优惠券 | 优惠券管理API | 新增 `pages/admin/coupon.vue` |
| 低 | 系统配置 | 设置平台基础参数（如服务费率、配送范围等） | 配置管理API | 新增 `pages/admin/settings.vue` |

## 四、通用功能

### 1. 搜索系统

| 优先级 | 功能点 | 详细描述 | 技术实现提示 | 关联文件 |
|--------|--------|----------|--------------|----------|
| 高 | 任务搜索 | 支持按关键词搜索任务标题、描述 | 搜索API + 防抖处理 | `pages/search/index.vue` |
| 中 | 骑手搜索 | 支持按姓名、评分搜索骑手 | 搜索API + 排序 | `pages/search/index.vue` |
| 低 | 历史搜索 | 记录用户搜索历史，提供快速访问 | 本地存储 | `pages/search/index.vue` |

### 2. 聊天系统

| 优先级 | 功能点 | 详细描述 | 技术实现提示 | 关联文件 |
|--------|--------|----------|--------------|----------|
| 高 | 实时聊天 | 订单相关的实时消息沟通 | WebSocket + 消息存储 | `pages/chat/detail.vue` |
| 中 | 消息历史 | 查看历史聊天记录 | 消息查询API | `pages/chat/list.vue` |
| 低 | 消息撤回 | 支持撤回已发送的消息 | 消息撤回API | `pages/chat/detail.vue` |

### 3. 地图集成

| 优先级 | 功能点 | 详细描述 | 技术实现提示 | 关联文件 |
|--------|--------|----------|--------------|----------|
| 高 | 地址选择 | 在发布任务时选择取件和送达地址 | 地图POI搜索 | `components/map-picker/map-picker.vue` |
| 中 | 地址管理 | 管理常用地址（家、宿舍、教室等） | 地址管理API | 新增 `pages/user/address.vue` |
| 低 | 距离计算 | 自动计算取件和送达地点之间的距离 | 地图SDK距离计算 | `components/map-picker/map-picker.vue` |

### 4. 性能优化

| 优先级 | 功能点 | 详细描述 | 技术实现提示 | 关联文件 |
|--------|--------|----------|--------------|----------|
| 高 | 图片懒加载 | 优化列表页图片加载性能 | Intersection Observer API | 全局组件 |
| 中 | 缓存策略 | 对不常变化的数据进行本地缓存 | localStorage + 缓存过期策略 | `api/request.js` |
| 低 | 代码分割 | 按需加载页面组件，减少初始加载时间 | Vite代码分割 | `vite.config.js` |

## 五、技术实现重点

### 1. 状态管理

| 功能点 | 技术实现提示 | 关联文件 |
|--------|--------------|----------|
| 全局状态管理 | 使用Pinia管理用户信息、订单状态等全局数据 | `store/index.js` |
| 持久化存储 | 关键数据持久化，防止页面刷新后丢失 | `store/index.js` |

### 2. API集成

| 功能点 | 技术实现提示 | 关联文件 |
|--------|--------------|----------|
| API统一管理 | 集中管理所有API请求，便于维护 | `api/errand.js` |
| 请求拦截器 | 统一处理Token、错误处理等 | `api/request.js` |

### 3. 安全措施

| 功能点 | 技术实现提示 | 关联文件 |
|--------|--------------|----------|
| XSS防护 | 对用户输入进行过滤，防止XSS攻击 | 全局处理 |
| 敏感信息保护 | 不在前端存储敏感信息，如密码等 | `api/request.js` |

## 六、项目结构优化

| 功能点 | 详细描述 | 关联文件 |
|--------|----------|----------|
| 组件复用 | 提取公共组件，如按钮、表单、卡片等 | `components/` |
| 样式规范 | 统一CSS变量，建立样式规范 | `uni.scss` |
| 代码规范 | 制定ESLint规则，保持代码风格一致 | `.eslintrc.js` |

## 七、开发优先级建议

1. **第一阶段**（核心功能）：
   - 用户资料编辑
   - 订单状态追踪
   - 支付集成
   - 实时聊天
   - 评价系统

2. **第二阶段**（增强功能）：
   - 身份认证
   - 任务筛选
   - 地图导航
   - 消息通知
   - 数据统计

3. **第三阶段**（完善功能）：
   - 优惠券系统
   - 管理端功能
   - 性能优化
   - 安全措施

## 八、总结

本待办清单基于对现有前端代码结构的分析，提供了详细的功能规划和技术实现建议。通过分阶段开发，可以确保核心功能优先实现，同时为后续功能扩展预留空间。建议在开发过程中，根据实际需求和技术难点，对清单进行适当调整和优化。